<!DOCTYPE html>
<html lang="en">
<head>
  <title>Hardmock - Connection Required</title>

  <meta charset="utf-8">
  <meta name="author" content="Zach Moazeni">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="/css/main.min.css?v=4" media="screen" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i,700" rel="stylesheet">
  <link rel="alternate" type="application/atom+xml" title="Connection Required" href="/feed/atom/" />
</head>
<body>
  <header>
    <nav class="row align-center">
      <div class="small-12 columns">
        <a class="brand text-center" href="/"><svg id="svg3542" height="21.913mm" width="168.74mm" version="1.1" viewBox="0 0 597.91431 77.643914">
 <defs id="defs3544">
  <filter id="filter6021" style="color-interpolation-filters:sRGB">
   <feFlood id="feFlood6023" result="flood" flood-opacity=".49804" flood-color="rgb(0,0,0)"/>
   <feComposite id="feComposite6025" operator="in" result="composite1" in2="SourceGraphic" in="flood"/>
   <feGaussianBlur id="feGaussianBlur6027" stdDeviation="3" result="blur" in="composite1"/>
   <feOffset id="feOffset6029" result="offset" dx="6" dy="6"/>
   <feComposite id="feComposite6031" operator="over" result="composite2" in2="offset" in="SourceGraphic"/>
  </filter>
 </defs>
 <g id="layer1" transform="translate(-623.9 295.03)">
  <g id="g6014" transform="translate(-153.57 1274.5)" filter="url(#filter6021)">
   <text id="text3365-6-5-6" style="word-spacing:0px;letter-spacing:0px" font-weight="600" font-size="50px" font-style="italic" y="-1510.3744" x="824.00177" font-family="&apos;Open Sans&apos;" xml:space="preserve"><tspan id="tspan3373-3-1-62" font-weight="600" font-size="50px" font-style="italic" y="-1510.3744" x="824.00177" font-family="&apos;Open Sans&apos;">Connec   ion </tspan></text>
   <path id="path3395-8-6-2-7" d="m1031.5-1538.9-15.848 0.076c-0.3921 0-0.6466-0.5346-0.4683-0.9871l8.7598-22.221c0.2634-0.6681-0.3814-1.314-0.8142-0.8157l-27.274 31.402c-0.35829 0.4126-0.13598 1.1803 0.34336 1.1855l14.468 0.1604c0.3772 0 0.6274 0.508 0.4739 0.9545l-7.3598 21.41c-0.2282 0.6636 0.3997 1.2649 0.8225 0.7874l27.243-30.763c0.3656-0.4127 0.139-1.1922-0.346-1.1899z"/>
   <text id="text3365-9-6-9-7" style="word-spacing:0px;letter-spacing:0px" font-weight="600" font-size="50px" font-style="italic" y="-1510.3744" x="1120.1641" font-family="&apos;Open Sans&apos;" xml:space="preserve"><tspan id="tspan3373-5-4-7-6" font-weight="600" font-size="50px" font-style="italic" y="-1510.3744" x="1120.1641" font-family="&apos;Open Sans&apos;">Required</tspan></text>
  </g>
 </g>
</svg>
 <span>Connection Required</span></a>
      </div>

      <a href="#" class="about" data-toggle="offCanvas" onclick="return false">about</a>
    </nav>
  </header>

  <div class="off-canvas position-left" id="offCanvas" data-off-canvas data-transition="overlap">
    <div class="sidebar">
  <button class="close-button" aria-label="Close menu" type="button" data-close>
    <span aria-hidden="true">&times;</span>
  </button>

  <div class="row">
    <h2 class="columns">About Zach</h2>
  </div>

  <div class="row">
    <div class="columns">
      <div class="row">
        <p class="columns">Zach is a software developer who has worked on a range of projects. He currently writes Ruby by day for <a href="https://www.getharvest.com/">Harvest</a> and plays with other languages by night (currently Haskell, Scala, Clojure, and Rust). He knows how to laugh at himself and loves to ship software. He is a father of two wonderful kids and a husband to a fantastic wife.</p>
      </div>

      <div class="row">
        <p class="columns">
          <a href="mailto:zach.moazeni@gmail.com">email</a> ϟ <a href="https://github.com/zmoazeni">github</a> ϟ <a href="https://twitter.com/zmoazeni">twitter</a> ϟ <a href="https://www.linkedin.com/in/zmoazeni/">linkedin</a>
        </p>
      </div>

      <h3 class="row columns">Notable Projects</h3>

      <div class="row">
        <ul class="columns">
          <li><a href="http://zmoazeni.github.io/csscss/">csscss</a></li>
          <li><a href="http://zmoazeni.github.io/harvested/">harvested</a></li>
          <li><a href="http://zmoazeni.github.io/gitspective/">gitspective</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="row columns">
    <img src="/uploads/me.jpg" alt="Picture of Zach" />
  </div>
</div>

  </div>

  <main class="off-canvas-content" data-off-canvas-content>
    
      <article>
        <div class="header">
          <div class="row">
            <h1 class="column">Hardmock</h1>
          </div>

          <div class="row">
            <p class="column"><time datetime="2007-04-25T02:03:09+00:00">2007-04-24</time></p>
          </div>
        </div>

        <div class="row align-left">
          <div class="column content">
            <p>Most ruby developers who use mock libraries are familiar with either <a href="http://mocha.rubyforge.org/">Mocha</a> or <a href="http://onestepback.org/software/flexmock/">Flex Mock</a>. However not many are familiar with the mock library that I use, <a href="http://hardmock.rubyforge.org/">Hardmock</a>.</p>

<p>Hardmock takes mocking one step further to assert order between mocks, much like the Java mocking library <a href="http://www.easymock.org/">EasyMock</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code>class Person
  def initialize(car, wallet)
@car = car
@wallet = wallet
  end

  def go_to_movies
@car.drive_to_movies
@wallet.pay_for_ticket("10.00")
@car.drive_home
  end
end

...

# in tests
def setup
  create_mocks :car_mock, :wallet_mock
  @person = Person.new(@car_mock, @wallet_mock)
end

# This test will pass
def test_go_to_movies
  @car_mock.expects.drive_to_movies
  @wallet_mock.expects.pay_for_ticket("10.00")
  @car_mock.expects.drive_home

  @person.go_to_movies
end

# This test will fail since we
# drive home before we paid for the ticket
def test_go_to_movies_failure
  @car_mock.expects.drive_to_movies
  @car_mock.expects.drive_home
  @wallet_mock.expects.pay_for_ticket("10.00")

  @person.go_to_movies
end
</code></pre>
</div>

<p>Another one of my favorite perks of Hardmock is the open assertions of parameters. For the most part, parameters are expected to equal what is given in the initial assertions, however sometimes there’s complications on asserting the parameters given.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>def test_allow_any_money_for_ticket
  @car_mock.expects.drive_to_movies
  @wallet_mock.expects.pay_for_ticket do | amount |
# this will be executed when "pay_for_ticket" is called on the mock

# Only allow dollar amounts
assert_match(/^\d+\.\d{2}$/, amount)

# of course the last value in this block
# with be returned from the mock to the caller
"the ticket"
  end
  @car_mock.expects.drive_home

  @person.go_to_movies
end
</code></pre>
</div>

<p>Hardmock was written by the solid developers at <a href="http://atomicobject.com/">Atomic Object</a></p>

          </div>
        </div>
      </article>
    
  </main>

  <footer class="row align-center text-center">
    <p class="column">&copy; 2007-2018 Zach Moazeni</p>
  </footer>

  <script src="/js/main.min.js"></script>
</body>
</html>

